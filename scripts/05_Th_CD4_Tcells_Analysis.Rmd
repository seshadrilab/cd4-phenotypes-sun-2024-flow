---
title: "Th Panel CD4 T cells Analysis"
author: "Jolie Phan"
output: 
  html_document:
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: no
  pdf_document:
    toc: yes
    toc_depth: 4
date: "version `r format(Sys.time(), '%B %d, %Y')`"
editor_options: 
  chunk_output_type: console
---

Of CD154+ and/or CD137+ CD4 T cells, analyze the expression of OX40, CTLA-4, RORyT, TBET, CXCR3, CCR6, CD45RA, CCR7, IFNg, IL17a.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Load libraries

```{r}
library(tidyverse)
library(flowWorkspace)
library(here)
library(ggplot2)
library(ggbeeswarm)
library(ggh4x)
source(here::here("scripts/Helper_Functions.R")) # for make_mag_plots() and multi_mag_plot()
```

# Load data

```{r}
gs <- load_gs(here::here("out/GatingSets/RSTR_Th_GatingSet"))

if(!dir.exists(here::here("out/Th_CD4_Tcells_Analysis"))) {
  cat(sprintf("Creating folder %s\n", here::here("out/Th_CD4_Tcells_Analysis")))
  dir.create(here::here("out/Th_CD4_Tcells_Analysis"), recursive = T)
}
```

# Add new gates

```{r}
# Grab CD4 gate paths
cd4_cd154_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD154+"
cd4_cd137_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD137+"
cd4_ox40_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/OX40+"
cd4_ctla4_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CTLA4+"
cd4_cd45ra_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD45RA+"
cd4_ccr7_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CCR7+"
cd4_cxcr3_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CXCR3+"
cd4_ccr6_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CCR6+"
cd4_roryt_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/RORyT+"
cd4_tbet_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/TBET+"
cd4_ifng_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/IFNg+"
cd4_il17a_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/IL17a/IL17a+"

# Add CD154+ OR CD137+ gate
gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_cd154_path,
                                                         "|", cd4_cd137_path))))),
           parent = "CD4+", name = "CD4_CD154+_OR_CD137+")

# Add other gates under CD154+_OR_CD137+ gates
gs_pop_add(gs, lapply(gs, gh_pop_get_gate, y = cd4_ox40_path),
           parent = "CD4_CD154+_OR_CD137+", name = "OX40+")

gs_pop_add(gs, lapply(gs, gh_pop_get_gate, y = cd4_ctla4_path),
           parent = "CD4_CD154+_OR_CD137+", name = "CTLA4+")

gs_pop_add(gs, lapply(gs, gh_pop_get_gate, y = cd4_cd45ra_path),
           parent = "CD4_CD154+_OR_CD137+", name = "CD45RA+")

gs_pop_add(gs, lapply(gs, gh_pop_get_gate, y = cd4_ccr7_path),
           parent = "CD4_CD154+_OR_CD137+", name = "CCR7+")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("!", cd4_cd45ra_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "CD45RA-")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_ccr7_path,
                                                         "&", cd4_cd45ra_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "CD45RA+CCR7+")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_ccr7_path,
                                                         "&!", cd4_cd45ra_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "TCM")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("!", cd4_ccr7_path,
                                                         "&", cd4_cd45ra_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "TEMRA")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("!", cd4_ccr7_path,
                                                         "&!", cd4_cd45ra_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "TEM")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_roryt_path,
                                                         "&", cd4_tbet_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "RORyT+TBET+")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_roryt_path,
                                                         "&!", cd4_tbet_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "RORyT+TBET-")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("!", cd4_roryt_path,
                                                         "&", cd4_tbet_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "RORyT-TBET+")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("!", cd4_roryt_path,
                                                         "&!", cd4_tbet_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "RORyT-TBET-")

gs_pop_add(gs, lapply(gs, gh_pop_get_gate, y = cd4_cxcr3_path),
           parent = "CD4_CD154+_OR_CD137+", name = "CXCR3+")

gs_pop_add(gs, lapply(gs, gh_pop_get_gate, y = cd4_ccr6_path),
           parent = "CD4_CD154+_OR_CD137+", name = "CCR6+")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_cxcr3_path,
                                                         "&", cd4_ccr6_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "CXCR3+CCR6+")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_cxcr3_path,
                                                         "&!", cd4_ccr6_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "CXCR3+CCR6-")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("!", cd4_cxcr3_path,
                                                         "&", cd4_ccr6_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "CXCR3-CCR6+")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("!", cd4_cxcr3_path,
                                                         "&!", cd4_ccr6_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "CXCR3-CCR6-")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_roryt_path,
                                                         "&", cd4_ccr6_path,
                                                         "&!", cd4_tbet_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "RORyT+TBET-CCR6+")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_tbet_path,
                                                         "&", cd4_cxcr3_path,
                                                         "&!", cd4_roryt_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "RORyT-TBET+CXCR3+")

gs_pop_add(gs, eval(substitute(flowWorkspace::booleanFilter(v),
                               list(v = as.symbol(paste0("", cd4_roryt_path,
                                                         "&", cd4_ifng_path,
                                                         "&!", cd4_tbet_path))))),
           parent = "CD4_CD154+_OR_CD137+", name = "RORyT+TBET-IFNg+")

gs_pop_add(gs, lapply(gs, gh_pop_get_gate, y = cd4_ifng_path),
           parent = "CD4_CD154+_OR_CD137+", name = "IFNg+")

gs_pop_add(gs, lapply(gs, gh_pop_get_gate, y = cd4_il17a_path),
           parent = "CD4_CD154+_OR_CD137+", name = "IL17a+")

gs_pop_add(gs, lapply(gs, gh_pop_get_gate, y = cd4_ccr6_path),
           parent = "CD4_CD154+_OR_CD137+/RORyT+TBET-", name = "CCR6+")

# Recompute the GatingSet 
flowWorkspace::recompute(gs)
```

# Extract frequencies

First, extract the frequencies for CD154+|CD137+ CD4 T cells.

```{r}
cd154_cd137_node <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+" 

cd154_cd137_counts <- pData(gs) %>%
  tibble::rownames_to_column("rowname") %>%
  left_join(gs_pop_get_count_fast(gs, subpopulations = cd154_cd137_node), by = c("rowname" = "name")) %>%
  dplyr::rename(Subpop = Count) %>%
  dplyr::select(rowname, "SAMPLE ID", "EXPERIMENT NAME", Stim, Status, Subpop, ParentCount) %>%
  mutate(Freq = (Subpop/ParentCount)*100)
  
cd154_cd137_counts$Status <- factor(cd154_cd137_counts$Status, levels = c("RSTR", "LTBI"))
```

Extract the frequencies of CD137+ CD4 T cells.

```{r}
cd137_counts <- pData(gs) %>%
  tibble::rownames_to_column("rowname") %>%
  left_join(gs_pop_get_count_fast(gs, subpopulations = cd4_cd137_path), by = c("rowname" = "name")) %>%
  dplyr::rename(Subpop = Count) %>%
  dplyr::select(rowname, "SAMPLE ID", "EXPERIMENT NAME", Stim, Status, Subpop, ParentCount) %>%
  mutate(Freq = (Subpop/ParentCount)*100)
  
cd137_counts$Status <- factor(cd137_counts$Status, levels = c("RSTR", "LTBI"))
```

Extract the frequencies of CCR6+ RORyT+TBET- CD154+|CD137+ CD4 T cells.

```{r}
ccr6_roryt_path <- "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/RORyT+TBET-/CCR6+"
  
ccr6_roryt_counts <- pData(gs) %>%
  tibble::rownames_to_column("rowname") %>%
  left_join(gs_pop_get_count_fast(gs, subpopulations = ccr6_roryt_path), by = c("rowname" = "name")) %>%
  dplyr::rename(Subpop = Count) %>%
  dplyr::select(rowname, "SAMPLE ID", "EXPERIMENT NAME", Stim, Status, Subpop, ParentCount) %>%
  mutate(Freq = (Subpop/ParentCount)*100)
  
ccr6_roryt_counts$Status <- factor(ccr6_roryt_counts$Status, levels = c("RSTR", "LTBI"))
```

Next, extract the frequencies of all other markers.

```{r}
nodes <- c("/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/OX40+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CTLA4+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CD45RA+CCR7+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/TCM",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/TEM",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/TEMRA",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/RORyT+TBET+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/RORyT+TBET-",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/RORyT-TBET+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/RORyT-TBET-",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CXCR3+CCR6+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CXCR3+CCR6-",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CXCR3-CCR6+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CXCR3-CCR6-",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/RORyT+TBET-CCR6+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/RORyT-TBET+CXCR3+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/IFNg+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/IL17a+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CD45RA+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CD45RA-",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CCR7+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CXCR3+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/CCR6+",
           "/Time/Cells/CD3+CD14-CD19-/Singlets/Live/CD3+ Lymphocytes/CD4 Positive/CD4+/CD4_CD154+_OR_CD137+/RORyT+TBET-IFNg+")
nodes_short <- str_replace(nodes, "\\/Time\\/Cells\\/CD3\\+\\CD14\\-\\CD19\\-\\/Singlets\\/Live\\/CD3\\+\\ Lymphocytes\\/CD4 Positive\\/CD4\\+\\/CD4\\_\\CD154\\+\\_\\OR\\_\\CD137\\+\\/", "")

count_list <- list()

for(pop in nodes) {
  current_counts <- pData(gs) %>%
    tibble::rownames_to_column("rowname") %>%
    left_join(gs_pop_get_count_fast(gs, subpopulations = pop), by = c("rowname" = "name")) %>%
    dplyr::rename(Subpop = Count) %>%
    dplyr::select(rowname, "SAMPLE ID", "EXPERIMENT NAME", Stim, Status, Subpop, ParentCount) %>%
    mutate(Freq = (Subpop/ParentCount)*100)
  
  current_counts$Status <- factor(current_counts$Status, levels = c("RSTR", "LTBI"))
  count_list[[pop]] <- current_counts
}

names(count_list) <- nodes_short

# Set color scheme and stims
fill_colors <- c("RSTR" = "#984EA3", "LTBI" = "#4DAF4A")
stims <- c("DMSO", "PP1", "TB WCL")
status <- c("RSTR", "LTBI")
```

# CD154|CD137

Compare between RSTR vs. LTBI.

```{r, fig.width=4, fig.height=5}
cd154_cd137_plots_status <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(cd154_cd137_counts, current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"), 
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = "CD154+|CD137+",
                                                 y_axis_text = "% CD4 T Cells", y_axis_size = 15,   ylim = c(0, 20))
                                })
names(cd154_cd137_plots_status) <- stims
cd154_cd137_plots_status
```

Compare among stims.

```{r, fig.width=6, fig.height=5}
cd154_cd137_plots_stim <- purrr::pmap(.l = list(status),
                                .f = function(n) {
                                  multi_mag_plot(cd154_cd137_counts, current_status = n,  groups_to_compare = c("DMSO", "PP1", "TB WCL"), 
                                                 subtitle = "CD154+|CD137+", fill_colors = fill_colors, y_axis_text = "% CD4 T Cells")
                                })
names(cd154_cd137_plots_stim) <- status
cd154_cd137_plots_stim
```

# CD137

```{r, fig.width=4, fig.height=5}
cd137_plots_status <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(cd137_counts, current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"), 
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = "CD137+",
                                                 y_axis_text = "% CD4 T Cells", y_axis_size = 15,   ylim = c(0, 10))
                                })
names(cd137_plots_status) <- stims
cd137_plots_status
```

# OX40

```{r, fig.width=4, fig.height=5}
ox40_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[1]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[1],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(50, 100))
                                })
names(ox40_plots) <- stims
ox40_plots
```

# CTLA-4

```{r, fig.width=4, fig.height=5}
ctla4_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[2]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[2],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 100))
                                })
names(ctla4_plots) <- stims
ctla4_plots
```

# Naive/naive-like

```{r, fig.width=4, fig.height=5}
naive_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[3]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[3],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 50))
                              })
names(naive_plots) <- stims
naive_plots
```

# TCM

```{r, fig.width=4, fig.height=5}
tcm_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[4]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[4],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 100))
                                })
names(tcm_plots) <- stims
tcm_plots
```

# TEM

```{r, fig.width=4, fig.height=5}
tem_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[5]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[5],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 50))
                                })
names(tem_plots) <- stims
tem_plots
```

# TEMRA

```{r, fig.width=4, fig.height=5}
temra_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[6]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[6],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 3))
                                })
names(temra_plots) <- stims
temra_plots
```

# RORyT and TBET

```{r, fig.width=4, fig.height=5}
# RORyT+TBET+
roryt_tbet_dp_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[7]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[7],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 60))
                                })
names(roryt_tbet_dp_plots) <- stims
roryt_tbet_dp_plots

# RORyT+TBET-
roryt_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[8]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[8],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 25))
                                })
names(roryt_plots) <- stims
roryt_plots

# RORyT-TBET+
tbet_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[9]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[9],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 100))
                                })
names(tbet_plots) <- stims
tbet_plots

# RORyT-TBET-
roryt_tbet_dn_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[10]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[10],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 100))
                                })
names(roryt_tbet_dn_plots) <- stims
roryt_tbet_dn_plots
```

# CXCR3 and CCR6

```{r, fig.width=4, fig.height=5}
cxcr3_ccr6_dp_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[11]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[11],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 50))
                                })
names(cxcr3_ccr6_dp_plots) <- stims
cxcr3_ccr6_dp_plots

cxcr3_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[12]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[12],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 40))
                                })
names(cxcr3_plots) <- stims
cxcr3_plots

ccr6_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[13]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[13],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 70))
                                })
names(ccr6_plots) <- stims
ccr6_plots

cxcr3_ccr6_dn_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[14]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[14],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 100))
                                })
names(cxcr3_ccr6_dn_plots) <- stims
cxcr3_ccr6_dn_plots
```

# RORyT+CCR6+

```{r, fig.width=4, fig.height=5}
roryt_ccr6_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[15]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[15],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 20))
                                })
names(roryt_ccr6_plots) <- stims
roryt_ccr6_plots
```

# TBET+CXCR3+

```{r, fig.width=4, fig.height=5}
tbet_cxcr3_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[16]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[16],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 40))
                                })
names(tbet_cxcr3_plots) <- stims
tbet_cxcr3_plots
```

# IFNg

```{r, fig.width=4, fig.height=5}
ifng_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[17]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[17],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 75))
                                })
names(ifng_plots) <- stims
ifng_plots
```

# IL17a

```{r, fig.width=4, fig.height=5}
il17a_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[18]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[18],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 14))
                                })
names(il17a_plots) <- stims
il17a_plots
```

# CD45RA

Agnostic of other markers.

```{r, fig.width=4, fig.height=5}
cd45ra_pos_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[19]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[19],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 50))
                                })
names(cd45ra_pos_plots) <- stims
cd45ra_pos_plots

cd45ra_neg_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[20]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[20],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(40, 100))
                                })
names(cd45ra_neg_plots) <- stims
cd45ra_neg_plots
```

# CCR7

Agnostic of other markers.

```{r, fig.width=4, fig.height=5}
ccr7_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[21]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[21],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(50, 100))
                                })
names(ccr7_plots) <- stims
ccr7_plots
```

# CXCR3

Agnostic of other markers.

```{r, fig.width=4, fig.height=5}
cxcr3_agnos_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[22]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[22],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 100))
                                })
names(cxcr3_agnos_plots) <- stims
cxcr3_agnos_plots
```

# CCR6

Agnostic of other markers.

```{r, fig.width=4, fig.height=5}
ccr6_agnos_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[23]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[23],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 100))
                                })
names(ccr6_agnos_plots) <- stims
ccr6_agnos_plots
```

# RORyT+TBET-IFNg+

```{r, fig.width=4, fig.height=5}
roryt_ifng_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(count_list[[nodes_short[24]]], current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"),
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = nodes_short[24],
                                                 y_axis_text = "% CD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(0, 0.25))
                                })
names(roryt_ifng_plots) <- stims
roryt_ifng_plots
```

# CCR6 of RORyT+TBET- CD154+|CD137+ CD4 T cells

```{r, fig.width=4, fig.height=5}
ccr6_roryt_plots <- purrr::pmap(.l = list(stims),
                                .f = function(n) {
                                  make_mag_plots(ccr6_roryt_counts, current_stim = n, num_comparisons = length(stims), groups_to_compare = c("RSTR", "LTBI"), 
                                                 paired = FALSE, adjust_p = FALSE, fill_colors = fill_colors, group_by_colname = "Status", subtitle = "CCR6+",
                                                 y_axis_text = "% RORyT+TBET-\nCD154+|CD137+ CD4 T Cells", y_axis_size = 15,   ylim = c(75, 100))
                                })
names(ccr6_roryt_plots ) <- stims
ccr6_roryt_plots 
```

# Save plots 

```{r}
cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CD154_CD137_DP_plots_by_status.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(cd154_cd137_plots_status[["DMSO"]])
print(cd154_cd137_plots_status[["PP1"]])
print(cd154_cd137_plots_status[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CD154_CD137_DP_plots_by_stim.pdf"), width=6, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(cd154_cd137_plots_stim[["RSTR"]])
print(cd154_cd137_plots_stim[["LTBI"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CD137_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(cd137_plots_status[["DMSO"]])
print(cd137_plots_status[["PP1"]])
print(cd137_plots_status[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_OX40_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(ox40_plots[["DMSO"]])
print(ox40_plots[["PP1"]])
print(ox40_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CTLA4_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(ctla4_plots[["DMSO"]])
print(ctla4_plots[["PP1"]])
print(ctla4_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_Naive_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(naive_plots[["DMSO"]])
print(naive_plots[["PP1"]])
print(naive_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_TCM_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(tcm_plots[["DMSO"]])
print(tcm_plots[["PP1"]])
print(tcm_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_TEM_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(tem_plots[["DMSO"]])
print(tem_plots[["PP1"]])
print(tem_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_TEMRA_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(temra_plots[["DMSO"]])
print(temra_plots[["PP1"]])
print(temra_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_RORyT_TBET_DP_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(roryt_tbet_dp_plots[["DMSO"]])
print(roryt_tbet_dp_plots[["PP1"]])
print(roryt_tbet_dp_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_RORyT_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(roryt_plots[["DMSO"]])
print(roryt_plots[["PP1"]])
print(roryt_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_TBET_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(tbet_plots[["DMSO"]])
print(tbet_plots[["PP1"]])
print(tbet_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_RORyT_TBET_DN_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(roryt_tbet_dn_plots[["DMSO"]])
print(roryt_tbet_dn_plots[["PP1"]])
print(roryt_tbet_dn_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CXCR3_CCR6_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(cxcr3_ccr6_dp_plots[["DMSO"]])
print(cxcr3_ccr6_dp_plots[["PP1"]])
print(cxcr3_ccr6_dp_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CXCR3_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(cxcr3_plots[["DMSO"]])
print(cxcr3_plots[["PP1"]])
print(cxcr3_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CCR6_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(ccr6_plots[["DMSO"]])
print(ccr6_plots[["PP1"]])
print(ccr6_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CXCR3_CCR6_DN_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(cxcr3_ccr6_dn_plots[["DMSO"]])
print(cxcr3_ccr6_dn_plots[["PP1"]])
print(cxcr3_ccr6_dn_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_RORyT_CCR6_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(roryt_ccr6_plots[["DMSO"]])
print(roryt_ccr6_plots[["PP1"]])
print(roryt_ccr6_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_TBET_CXCR3_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(tbet_cxcr3_plots[["DMSO"]])
print(tbet_cxcr3_plots[["PP1"]])
print(tbet_cxcr3_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_IFNg_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(ifng_plots[["DMSO"]])
print(ifng_plots[["PP1"]])
print(ifng_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_IL17a_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(il17a_plots[["DMSO"]])
print(il17a_plots[["PP1"]])
print(il17a_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CD45RA_Pos_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(cd45ra_pos_plots[["DMSO"]])
print(cd45ra_pos_plots[["PP1"]])
print(cd45ra_pos_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CD45RA_Neg_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(cd45ra_neg_plots[["DMSO"]])
print(cd45ra_neg_plots[["PP1"]])
print(cd45ra_neg_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CCR7_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(ccr7_plots[["DMSO"]])
print(ccr7_plots[["PP1"]])
print(ccr7_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CXCR3_agnos_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(cxcr3_agnos_plots[["DMSO"]])
print(cxcr3_agnos_plots[["PP1"]])
print(cxcr3_agnos_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CCR6_agnos_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(ccr6_agnos_plots[["DMSO"]])
print(ccr6_agnos_plots[["PP1"]])
print(ccr6_agnos_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_RORyT_IFNg_DP_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(roryt_ifng_plots[["DMSO"]])
print(roryt_ifng_plots[["PP1"]])
print(roryt_ifng_plots[["TB WCL"]])
dev.off()

cairo_pdf(file=here::here("out/Th_CD4_Tcells_Analysis/Th_CD4_CCR6_of_RORyT_plots.pdf"), width=4, height=5,
          onefile = TRUE, bg = "transparent", family = "Arial") # default unit is inches, default font is Helvetica.
print(ccr6_roryt_plots[["DMSO"]])
print(ccr6_roryt_plots[["PP1"]])
print(ccr6_roryt_plots[["TB WCL"]])
dev.off()
```
